{
  "Statement": [
    {
      "Action": [
        "cloudtrail:DeleteTrail",
        "cloudtrail:PutEventSelectors",
        "cloudtrail:StopLogging",
        "cloudtrail:UpdateTrail"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*"
          ]
        }
      },
      "Effect": "Deny",
      "Resource": [
        "arn:aws:cloudtrail:*:*:trail/${ACCELERATOR_PREFIX}*"
      ],
      "Sid": "CT"
    },
    {
      "Action": [
        "config:DeleteConfigurationRecorder",
        "config:DeleteDeliveryChannel",
        "config:DeleteRetentionConfig*",
        "config:PutConfigurationRecorder",
        "config:PutDeliveryChannel",
        "config:PutRetentionConfig*",
        "config:StopConfigurationRecorder",
        "config:DeleteAggregationAuthorization",
        "config:DeleteConfigurationAggregator",
        "config:PutAggregationAuthorization",
        "config:PutConfigurationAggregator"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${ORG_ADMIN_ROLE}"
          ]
        }
      },
      "Effect": "Deny",
      "Resource": [
        "*"
      ],
      "Sid": "CON"
    },
    {
      "Action": [
        "events:PutRule",
        "events:PutTargets",
        "events:RemoveTargets",
        "events:DisableRule",
        "events:DeleteRule"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*"
          ]
        }
      },
      "Effect": "Deny",
      "Resource": [
        "arn:aws:events:*:*:rule/${ACCELERATOR_PREFIX}*"
      ],
      "Sid": "CWE"
    },
    {
      "Action": [
        "config:PutConfigRule",
        "config:DeleteConfigRule",
        "config:DeleteEvaluationResults"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${ORG_ADMIN_ROLE}"
          ]
        }
      },
      "Effect": "Deny",
      "Resource": [
        "arn:aws:config:*:*:config-rule/*"
      ],
      "Sid": "RUL"
    },
    {
      "Action": [
        "kms:DeleteAlias",
        "kms:UpdateAlias",
        "kms:DisableKey",
        "kms:ImportKeyMaterial",
        "kms:PutKeyPolicy",
        "kms:ScheduleKeyDeletion"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*"
          ]
        }
      },
      "Effect": "Deny",
      "Resource": "arn:aws:kms:::alias/${ACCELERATOR_PREFIX_ND}*"
    },
    {
      "Action": [
        "iam:CreatePolicy",
        "iam:DeletePolic*",
        "iam:SetDefaultPolicyVersion",
        "iam:CreatePolicyVersion"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*"
          ]
        }
      },
      "Effect": "Deny",
      "Resource": "arn:aws:iam::*:policy/${ACCELERATOR_PREFIX}*",
      "Sid": "IAM"
    },
    {
      "Action": [
        "acm:DeleteCert*",
        "acm:ExportCert*",
        "acm:RemoveTagsFromCert*",
        "elasticloadbalancing:DeleteLoadBal*",
        "elasticloadbalancing:DeleteTargetG*"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalArn": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*"
          ]
        },
        "StringEquals": {
          "aws:ResourceTag/Accelerator": "${ACCELERATOR_NAME}"
        }
      },
      "Effect": "Deny",
      "Resource": "*",
      "Sid": "ACM"
    },
    {
      "Action": [
        "guardduty:AcceptInvitation",
        "guardduty:DeclineInvitations",
        "guardduty:Delete*",
        "guardduty:Disassociate*",
        "guardduty:StopMonitoringMembers",
        "guardduty:UpdateDetector",
        "guardduty:UpdateFindingsFeedback",
        "guardduty:UpdatePublishingDestination",
        "guardduty:UpdateOrganizationConfiguration",
        "guardduty:DisableOrganizationAdminAccount",
        "guardduty:CreateMembers",
        "guardduty:InviteMembers",
        "securityhub:AcceptInvitation",
        "securityhub:DeclineInvitations",
        "securityhub:DeleteInvitations",
        "securityhub:DeleteMembers",
        "securityhub:InviteMembers",
        "securityhub:CreateMembers",
        "securityhub:DisableSecurityHub",
        "securityhub:DisassociateFromMasterAccount",
        "securityhub:DeleteInsight",
        "securityhub:DisassociateMembers",
        "securityhub:DeleteActionTarget",
        "securityhub:BatchDisableStandards",
        "securityhub:UpdateSecurityHubConfiguration",
        "securityhub:UpdateStandardsControl",
        "macie2:AcceptInvitation",
        "macie2:CreateInvitations",
        "macie2:CreateMember",
        "macie2:DeclineInvitations",
        "macie2:DeleteInvitations",
        "macie2:DeleteMember",
        "macie2:DisableMacie",
        "macie2:DisableOrganizationAdminAccount",
        "macie2:Disassociate*",
        "macie2:EnableMacie",
        "macie2:EnableOrganizationAdminAccount",
        "macie2:UpdateMacieSession",
        "macie2:UpdateMemberSession",
        "macie2:UpdateOrganizationConfiguration",
        "fms:DisassociateAdminAccount",
        "access-analyzer:DeleteAnalyzer",
        "account:EnableRegion",
        "account:DisableRegion",
        "iam:DeleteAccountPasswordPolicy",
        "iam:UpdateAccountPasswordPolicy",
        "ec2:CreateDefaultVpc",
        "ec2:DisableEbsEncryptionByDefault",
        "s3:PutAccountPublicAccessBlock",
        "ds:UnshareDirectory",
        "ram:Delete*",
        "ram:Disassociate*",
        "ram:Update*"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*"
          ]
        }
      },
      "Effect": "Deny",
      "Resource": "*",
      "Sid": "SEC"
    }
  ],
  "Version": "2012-10-17"
}